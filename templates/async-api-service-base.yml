asyncapi: '2.6.0'
id: {{ .ServiceID }} # urn:whds:com:domain:service_name
info:
  # meta: service1
  title: Streetlights Kafka 
  version: '1.0.0'
  description: |
    The Smartylighting Streetlights API allows you to remotely manage the city lights.
    ### Check out its awesome features:
    * Turn a specific streetlight on/off ðŸŒƒ
    * Dim a specific streetlight ðŸ˜Ž
    * Receive real-time information about environmental lighting conditions ðŸ“ˆ


  license:
    name: Apache 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0
servers:
  dev:
    url: test.servicebus.org
    protocol: amqp
    description: Test broker
    security:
      - saslScram: []
  preprod:
    url: preprod.servicebus.org
    protocol: amqp
    description: Test broker
    security:
      - saslScram: []
  prod:
    url: prod.servicebus.org
    protocol: amqp
    description: Test broker
    security:
      - saslScram: []
defaultContentType: application/json
channels:
  topic_name:
    description: The topic on which this app publishes telemtry
    parameters:
      streetlightId:
        description: The ID of the streetlight.
        schema:
          type: string
    publish:
      summary: | 
        Inform about environmental lighting conditions of a particular streetlight.
      operationId: receiveLightMeasurement
      traits:
        - amqp:
            bindings:
              amqp:
                clientId: service_name
      message:
        name: lightMeasured
        title: Light measured
        summary: | 
          {{ .MessageDescription }} Inform about environmental lighting conditions of a particular streetlight.
        contentType: application/json
        # examples: {}
        traits:
          - headers:
              type: object
              properties:
                my-app-header:
                  type: integer
                  minimum: 0
                  maximum: 100
        payload:
          type: object
          properties:
            lumens:
              type: integer
              minimum: 0
              description: Light intensity measured in lumens.
            sentAt:
              type: string
              format: date-time
              description: Date and time when the message was sent.

